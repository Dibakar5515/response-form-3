<!-- shortened for clarity, only JavaScript part is shown here -->
<script>
  // ... previous functions like addEntry, removeEntry, showPreview ...

  document.getElementById("responseForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const form = e.target;
    const formData = new FormData(form);
    const submitBtn = document.getElementById("submitBtn");
    const successMessage = document.getElementById("successMessage");

    submitBtn.classList.add("loading");

    fetch("https://script.google.com/a/macros/tnu.in/s/AKfycbzgge_iXzvjRHRUiSAWruiT0XR0HxVhcC11-p_LB3XZu4vPjycZTbKlwooP3A2HdR2C/exec", {
      method: "POST",
      body: formData
    })
    .then(response => {
      if (!response.ok) throw new Error("HTTP error " + response.status);
      return response.text();
    })
    .then(result => {
      successMessage.style.display = "block";
      form.reset();
      document.getElementById("subjectContainer").innerHTML = "";
      document.getElementById("previewSection").style.display = "none";
      document.getElementById("submitBtn").style.display = "none";
      submitBtn.classList.remove("loading");
      addEntry(); addEntry(); addEntry();
    })
    .catch(error => {
      console.error("Submission failed:", error.message);
      alert("There was a problem submitting the form.\n" + error.message);
      submitBtn.classList.remove("loading");
    });
  });
</script>
